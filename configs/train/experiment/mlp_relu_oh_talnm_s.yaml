# @package _global_

defaults:
  - override /train_dataset: talnm_mn04_v1
  - override /val_dataset: talnm_mn04_v1
  - override /m_preset: mlp_relu_oh


########## hyperparameters 

m_preset: # 7_543_488 parameters
  cfg:
    hidden_features: 1536
    num_blocks: 2

solver:
  lr: 5.00e-3
  optimizer:
    betas:
      - 0.832
      - 0.941
    eps: 2.24e-9

  scheduler:
    total_steps: 20000 # not an HP, must be (num_epochs * num_training_examples) / batch_size
    milestone: 7500
    final_lr: 1.36e-6

########## training setup
train_dataset:
  loader:
    batch_size: 512

trainer:
  # kwargs for lightning trainer
  max_epochs: 1
  
  # set True to to ensure deterministic results
  # makes training slower but gives more reproducibility than just setting seeds
  deterministic: True
  

########## old hyperparameters 

# m_preset: # 3_459_264 parameters
#   cfg:
#     hidden_features: 1024
#     num_blocks: 2

# solver:
#   lr: 8.94e-3
#   optimizer:
#     betas:
#       - 0.804
#       - 0.931
#     eps: 2.08e-10

#   scheduler:
#     total_steps: 20000 # not an HP, must be (num_epochs * num_training_examples) / batch_size
#     milestone: 7500
#     final_lr: 1.24e-7